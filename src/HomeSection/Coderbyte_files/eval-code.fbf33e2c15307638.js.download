function __evalCode(codeObject,challengeObject,callback){if(!codeObject||(!codeObject.code&&codeObject.code!=='')){console.log('error with code eval, (code) key needs to exist in code object');return callback('error')}
if(!challengeObject||!challengeObject.language||!challengeObject.parameter_type||!challengeObject.editor_type){console.log('error with code eval, (language, parameter_type, editor_type) keys needs to exist in challenge object');return callback('error')}
var codeRunnerServer='https://cb-code-runner-service-746e2ae8b8ee.herokuapp.com/backend/coderunner/';var executeFile=challengeObject.execute_file?challengeObject.execute_file:'executeCodeTPS.php';var code=codeObject.code;var language=challengeObject.language;var file_mapping=window.__MAIN_LANGUAGE_LIST[language].file_mapping;var input1=(codeObject.inputs&&codeObject.inputs.length>0)?codeObject.inputs[0]:undefined;var input2=(codeObject.inputs&&codeObject.inputs.length>1)?codeObject.inputs[1]:undefined;var username=codeObject.username?codeObject.username:null;if(challengeObject.parameter_type==='str'){if(input1[0]!=='"'&&input1[input1.length-1]!=='"'){input1='"'+input1+'"'}}
if(input1&&challengeObject.editor_type==='algorithm'&&challengeObject.tier!=='7'){input1=input1.replace(/\$/g,'$$$$');code=window['stdin_mod_'+language](input1,input2,code)}
var params={code:code,language:language.toLowerCase(),file_mapping:file_mapping,username:username,};if(challengeObject.preview_mode){params.preview_mode=challengeObject.preview_mode}
if(codeObject.filetree){params.filetree=JSON.stringify(codeObject.filetree)}
if((params.filetree&&params.filetree.includes('API_KEY_DO_NOT_MODIFY'))||params.code.includes('API_KEY_DO_NOT_MODIFY')){codeRunnerServer='/backend/requests/coderunner/'}
$.post(codeRunnerServer+executeFile,params,function(data){callback(data)})}
function __evalSQLCode(codeObject,challengeObject,callback){if(!codeObject||!codeObject.code){console.log('error with code eval, (code) key needs to exist in code object');return callback('error')}
if(!challengeObject||!challengeObject.challenge_title||!challengeObject.table_name){console.log('error with code eval, (challenge_title, table_name) keys needs to exist in challenge object');return callback('error')}
var params={code:codeObject.code,challenge_title:challengeObject.challenge_title,table_name:challengeObject.table_name,db_type:challengeObject.db_type?challengeObject.db_type:'mysql',};if(challengeObject.custom_db_url){params.custom_db_url=challengeObject.custom_db_url}
$.post('/backend/requests/coderunner/executeSQL.php',params,function(data){callback(data)})}
function __evalMongoDBCode(codeObject,challengeObject,callback){if(!codeObject||!codeObject.code){console.log('error with code eval, (code) key needs to exist in code object');return callback('error')}
if(!challengeObject||!challengeObject.challenge_title||!challengeObject.collection_name){console.log('error with code eval, (challenge_title, table_name) keys needs to exist in challenge object');return callback('error')}
try{JSON.parse(codeObject.code)}catch(e){callback(JSON.stringify({'output':'Error: invalid JSON sent to database command',}));return}
var params={code:JSON.stringify(JSON.parse(codeObject.code)),challenge_title:challengeObject.challenge_title,collection_name:challengeObject.collection_name,};$.post('/backend/requests/coderunner/executeMongoDBQuery.php',params,function(data){callback(data)})}
function __evalGraphQLCode(codeObject,challengeObject,callback){if(!codeObject||!codeObject.code){console.log('error with code eval, (code) key needs to exist in code object');return callback('error')}
if(!challengeObject||!challengeObject.challenge_title){console.log('error with code eval, (challenge_title) keys needs to exist in challenge object');return callback('error')}
var params={code:codeObject.code,challenge_title:challengeObject.challenge_title,};$.post('/backend/requests/coderunner/executeGraphQL.php',params,function(data){callback(data)})}
function __evalFrontendCode(codeObject,challengeObject,callback){if(!codeObject||(!codeObject.code&&codeObject.code!=='')){console.log('error with code eval, (code) key needs to exist in code object');return callback('error')}
var usingOurSandbox={'React':'react','Angular':'angular','Vue':'vue','Vue3':'vue3','AngularJS':'angularjs','Flutter':'flutter','ReactTypeScript':'react-ts','ReactNative':'react-native','JavaScript':'webpack','Webpack':'webpack','Svelte':'svelte','HTML':'html','Bootstrap':'html',};var frontEndSandboxUrl=codeObject.useFrontEndTestRoute?'https://cbfe.app/test/':'https://cbfe.app/project/';var parameters;var baseLanguage;if(challengeObject.challenge_title.indexOf('HTML')!==-1)baseLanguage='HTML';if(challengeObject.challenge_title.indexOf('Bootstrap')!==-1)baseLanguage='HTML';if(challengeObject.challenge_title.indexOf('React')!==-1)baseLanguage='React';if(challengeObject.challenge_title.indexOf('React TypeScript')!==-1)baseLanguage='ReactTypeScript';if(challengeObject.challenge_title.indexOf('React Native')!==-1)baseLanguage='ReactNative';if(challengeObject.challenge_title.indexOf('ReactNative')!==-1)baseLanguage='ReactNative';if(challengeObject.challenge_title.indexOf('Flutter')!==-1)baseLanguage='Flutter';if(challengeObject.challenge_title.indexOf('JavaScript')!==-1)baseLanguage='JavaScript';if(challengeObject.challenge_title.indexOf('Webpack')!==-1)baseLanguage='Webpack';if(challengeObject.challenge_title.indexOf('Vue')!==-1)baseLanguage='Vue';if(challengeObject.challenge_title.indexOf('Vue3')!==-1)baseLanguage='Vue3';if(challengeObject.challenge_title.indexOf('Svelte')!==-1)baseLanguage='Svelte';if(challengeObject.challenge_title.indexOf('Angular')!==-1)baseLanguage='Angular';if(challengeObject.challenge_title.indexOf('AngularJS')!==-1)baseLanguage='AngularJS';if((challengeObject.ungraded||challengeObject.unitTests)&&challengeObject.language){baseLanguage=challengeObject.language;baseLanguage=baseLanguage.replace('Vue.js','Vue')}
if(baseLanguage&&usingOurSandbox[baseLanguage]){parameters=window.__DEFAULT_CODE_FRONTEND_BASE_CODERBYTE[baseLanguage](codeObject.code);frontEndSandboxUrl+=usingOurSandbox[baseLanguage];if(codeObject.frontEndRenderingKey){frontEndSandboxUrl+='/'+codeObject.frontEndRenderingKey}
if(codeObject.filetree){var containsTsx=!1;var containsNativeLib=!1;var newFileTreeStructure={'files':{}};var node;for(var i=0;i<codeObject.filetree.length;i++){node=codeObject.filetree[i];if(!node.content||node.content==='')continue;newFileTreeStructure.files[node.name]={content:node.content};if(!containsTsx&&node.name.indexOf('.tsx')!==-1&&baseLanguage==='React'){containsTsx=!0}
if(!containsNativeLib&&node.content.indexOf('react-native')!==-1&&baseLanguage==='React'){containsNativeLib=!0}}
parameters=newFileTreeStructure;if(containsTsx){frontEndSandboxUrl=frontEndSandboxUrl.replace('react','react-ts')}else if(containsNativeLib){frontEndSandboxUrl=frontEndSandboxUrl.replace('react','react-native')}}
if(codeObject.runningUnitTests&&codeObject.frontEndRenderingKey){frontEndSandboxUrl='https://cbfe.app/unit/'+codeObject.frontEndRenderingKey}}else{console.log('error running front-end code',challengeObject);return callback('error')}
if(window.sessionRewind){parameters.srApiKey='o296GYG7Zc9myJ5SRKnuQ7UURGME9j8aaMLIwqX4'}
fetch(frontEndSandboxUrl,{method:codeObject.runningUnitTests?'GET':'POST',headers:{'Content-Type':'application/json','Accept':'application/json'},body:codeObject.runningUnitTests?undefined:JSON.stringify(parameters)}).then(x=>x.json()).then(data=>{callback(data)}).catch((error)=>{console.log('error with front-end sandbox',error);callback(error)})}